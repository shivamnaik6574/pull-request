name: Auto Create Pull Request

on:
  push:
    branches:
      - main  # Change this to the default branch of your repository

jobs:
  create_pr:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Get the latest commit SHA
        run: |
          latest_commit=$(git rev-parse HEAD)
          echo "::set-output name=latest_commit::$latest_commit"

      - name: Create Pull Request
        run: |
          latest_commit=${{ needs.create_pr.outputs.latest_commit }}
          commit_msg=$(git log --format=%B -n 1 $latest_commit)
          pr_title="Auto PR: $commit_msg"
          pr_body="Automatically generated PR for commit $latest_commit"
          gh pr create --base main --head $latest_commit --title "$pr_title" --body "$pr_body"
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
